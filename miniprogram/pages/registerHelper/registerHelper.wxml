<!--pages/registerHelper/registerHelper.wxml-->
<view class="register-helper-page">
  <!-- 功能未完成提示弹窗 -->
  <cloud-tip-modal 
    showTipProps="{{showUnfinishedModal}}" 
    title="功能开发中" 
    content="该功能还未完成，敬请期待！" 
    modalType="center"
    bindclose="onModalClose"
  ></cloud-tip-modal>
  <!-- 缴费提示弹窗 -->
  <view class="payment-modal" wx:if="{{showPaymentModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">完成缴费</text>
        <view class="close-btn" bindtap="closePaymentModal">×</view>
      </view>
      <view class="modal-body">
        <text class="payment-content">支付功能正在开发中，点击完成继续。</text>
      </view>
      <view class="modal-footer">
        <button class="btn btn-confirm" bindtap="onPaymentComplete">完成</button>
      </view>
    </view>
  </view>
  <!-- 对话历史区域 -->
  <scroll-view class="chat-history" scroll-y="true">
    <!-- 消息列表 -->
    <view wx:for="{{messages}}" wx:key="index" class="message {{item.type}}-message">
      <view class="content">
        <text class="text">{{item.content}}</text>
        <!-- 选项区域 -->
        <view wx:if="{{item.options && item.options.length > 0}}" class="options">
          <view wx:for="{{item.options}}" wx:for-item="option" wx:key="option" class="option" bindtap="selectOption">
            {{option}}
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 用户输入区域 -->
  <view class="input-area">
    <textarea 
      class="input-box" 
      placeholder="请描述您的症状..." 
      value="{{userInput}}"
      bindinput="onInputChange"
      auto-height="{{true}}"
      maxlength="500"
      placeholder-style="color:#999;"
    />
    <button class="send-btn" bindtap="sendMessage">发送</button>
  </view>

  <!-- 信息总结和挂号对话框 -->
  <view class="summary-modal" wx:if="{{showSummaryModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">挂号信息确认</text>
        <view class="close-btn" bindtap="closeSummaryModal">×</view>
      </view>
      <view class="modal-body">
        <text class="summary-title">您的症状总结：</text>
        <text class="summary-content">头痛、发热(38.5℃)，持续2天，伴有咳嗽</text>
        <view class="form-group">
          <text class="label">就诊科室：</text>
          <input class="form-input" value="呼吸内科" disabled />
        </view>
        <view class="form-group">
          <text class="label">主诉：</text>
          <input class="form-input" value="头痛发热2天伴咳嗽" bindinput="onComplaintChange" />
        </view>
        <view class="form-group">
          <text class="label">体温：</text>
          <input class="form-input" type="number" value="38.5" bindinput="onTemperatureChange" />
        </view>
      </view>
      <view class="modal-footer">
        <button class="btn btn-cancel" bindtap="closeSummaryModal">取消</button>
        <button class="btn btn-confirm" bindtap="confirmRegistration">确认挂号</button>
      </view>
    </view>
  </view>

  <!-- 底部下一步按钮 -->
  <view class="bottom-btn-area">
    <button class="next-btn" bindtap="nextStep">下一步</button>
  </view>
</view>